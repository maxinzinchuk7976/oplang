; rdi filename, rsi envoriment
; 0x00-0x08 rbp
; 0x08-0x10 filename
; 0x10-0x18 envoriment
; 0x18-0x20 buffer
; 0x20-0x28 backpatch_list
; 0x28-0x30 scope
; 0x30-0x38 position
; 0x38-0x40 list
&fn_assembly_envoriment ; rdi filename, rsi envoriment, rdx buffer, rcx backpatch_list
4851
4852
4853
4856
4857
    c8 4000 00 ; enter 0x38, 0
        48897df0 ; mov [rbp-0x10], rdi
        488975e8 ; mov [rbp-0x18], rsi
        488955e0 ; mov [rbp-0x20], rdx
        488b36   ; mov rsi, [rsi]
        488975c0 ; mov [rbp-0x40], rsi
        488b4e18 ; mov rcx, [rsi+0x18]
        48894dc8 ; mov [rbp-0x38], rcx

        &fn_assembly_envoriment_loop
            ;e8*fn_print_rcx
            48837dc800 ; cmp [rbp-0x38], 0
            7e1*done_fn_assembly_envoriment_loop
            ff4dc8   ; dec [rbp-0x38]
            488b4dc8 ; mov rcx, [rbp-0x38]
            488b7dc0 ; mov rdi, [rbp-0x40]
            e8*fn_hlist_get
            4833c9 ; xor rcx, rcx
            8b08 ; mov rcx, [rax]
            4829c8 ; sub rax, rcx
            803801 ; cmp [rax], 1
            751*fn_assembly_envoriment_default
                488b7de0 ; mov rdi, [rbp-0x20]
                e8*fn_assembly_handle_hex
                eb1*fn_assembly_envoriment_loop
            &fn_assembly_envoriment_default
        eb1*fn_assembly_envoriment_loop
        &done_fn_assembly_envoriment_loop

        488b7df0 ; mov [rbp-0x10], rdi
        e8*fn_create_file
        488bf8 ; mov rdi, rax
        488b75e0 ; mov rsi, [rbp-0x20]
        488b5610 ; mov rdx, [rsi+0x10]
        488b36 ; mov rsi, [rsi]
        b801000000
        0f05
    c9
485f
485e
485b
485a
4859
c3
